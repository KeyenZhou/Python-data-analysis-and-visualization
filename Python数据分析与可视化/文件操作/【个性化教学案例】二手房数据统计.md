# 二手房数据统计

文件[house.csv](./数据集/house.csv)中存储一些二手房数据，中文编码为GBK，对文件中的数据进行统计分析。  
文件中数据格式如下所示：
市区,小区,户型,朝向,楼层,装修情况,电梯,面积(㎡),价格(万元),年份
海淀,毛纺住宅北小区,3室1厅,东西,14,简装,无电梯,97,630,1997
海淀,知春里,3室1厅,南北,6,其他,无电梯,73,910,1988
海淀,北蜂窝30号院,2室1厅,南北,5,简装,无电梯,50,385,1980
海淀,雅世合金公寓,2室1厅,东南,9,精装,有电梯,85,830,2011
海淀,新起点嘉园,2室1厅,西北,20,精装,有电梯,124,1400,2003
海淀,学院南路丙10号院,2室1厅,南,5,简装,无电梯,50,450,1991
......
# 1. 读文件查看数据


```python
def read_csv(file):
    """接收文件名为参数，返回二维列表"""
    data_ls = []
    with open(file,'r',encoding='GBK') as fr:  # 以读模式创建文件对象，fr为文件对象名，表示file read，文件编码为GBK
        for line in fr:     # 遍历文件中行
            line_ls = line.strip().split(',')  # 去掉行末换行符，根据逗号切分为列表
            data_ls.append(line_ls)            # 当前行切得的列表加入到列表中
    return data_ls


if __name__ == '__main__':
    filename = '/data/bigfiles/house.csv'     # 文件名
    house_info = read_csv(filename)  # 返回二维列表
    print(house_info[:10])  # 查看前10行数据

```

# 2. 排序

## 2.1 输出价格由高到低的10个房源

按价格降序排序，注意价格要转数值类型：


```python
def read_csv(file):
    """接收文件名为参数，返回二维列表"""
    data_ls = []
    with open(file, 'r', encoding='GBK') as fr:  # 以读模式创建文件对象，fr为文件对象名，表示file read，文件编码为GBK
        for line in fr:  # 遍历文件中行
            line_ls = line.strip().split(',')  # 去掉行末换行符，根据逗号切分为列表
            data_ls.append(line_ls)  # 当前行切得的列表加入到列表中
    return data_ls


def sorted_by_n(data_ls, n):
    """接收二维列表为参数，返回根据序号为n的列降序排序的二维列表"""
    data_of_sort = sorted(data_ls[1:], key=lambda x: float(x[n]), reverse=True)
    return [data_ls[0]] + data_of_sort


if __name__ == '__main__':
    filename = '/data/bigfiles/house.csv'  # 文件名
    house_info = read_csv(filename)  # 返回二维列表
    print(sorted_by_n(house_info, 8)[:10])  # 查看前10行数据

```
[['市区', '小区', '户型', '朝向', '楼层', '装修情况', '电梯', '面积(㎡)', '价格(万元)', '年份'], 
['海淀', '紫御府', '4室2厅', '南北', '12', '精装', '有电梯', '374', '4368', '2008'], 
['海淀', '西山壹号院', '4室3厅', '东南', '6', '毛坯', '有电梯', '561', '4150', '2011'], 
['海淀', '西山壹号院', '3室3厅', '西南', '6', '精装', '有电梯', '321', '3850', '2011'], 
['海淀', '西山壹号院', '4室2厅', '西南', '6', '毛坯', '有电梯', '347', '3750', '2011'], 
['海淀', '西山壹号院', '4室2厅', '西南', '6', '毛坯', '有电梯', '347', '3750', '2011'], 
['海淀', '鲁艺上河村三区', '4室2厅', '南北', '11', '精装', '无电梯', '263', '3750', '2006'], 
['海淀', '万泉新新家园', '4室2厅', '南北', '6', '精装', '有电梯', '286', '3600', '2001'], 
['海淀', '西山壹号院', '4室3厅', '南北', '6', '精装', '无电梯', '435', '3500', '2013'], 
['海淀', '龙湖唐宁one', '4室2厅', '南北', '31', '精装', '有电梯', '378', '3500', '2011']]
## 2.2 输出面积由高到低的10个房源

与2.2相同的代码，只要传不同的参数n就可以：


```python
def read_csv(file):
    """接收文件名为参数，返回二维列表"""
    data_ls = []
    with open(file, 'r', encoding='GBK') as fr:  # 以读模式创建文件对象，fr为文件对象名，表示file read，文件编码为GBK
        for line in fr:  # 遍历文件中行
            line_ls = line.strip().split(',')  # 去掉行末换行符，根据逗号切分为列表
            data_ls.append(line_ls)  # 当前行切得的列表加入到列表中
    return data_ls


def sorted_by_n(data_ls, n):
    """接收二维列表为参数，返回根据序号为n的列降序排序的二维列表"""
    data_of_sort = sorted(data_ls[1:], key=lambda x: float(x[n]), reverse=True)
    return [data_ls[0]] + data_of_sort


if __name__ == '__main__':
    filename = '/data/bigfiles/house.csv'  # 文件名
    house_info = read_csv(filename)  # 返回二维列表
    print(sorted_by_n(house_info, 7)[:10])  # 查看前10行数据

```
[['市区', '小区', '户型', '朝向', '楼层', '装修情况', '电梯', '面积(㎡)', '价格(万元)', '年份'], 
['海淀', '西山壹号院', '4室3厅', '东南', '6', '毛坯', '有电梯', '561', '4150', '2011'], 
['海淀', '西山壹号院', '4室3厅', '南北', '6', '精装', '无电梯', '435', '3500', '2013'], 
['海淀', '龙湖唐宁one', '4室2厅', '南北', '31', '精装', '有电梯', '378', '3500', '2011'], 
['海淀', '紫御府', '4室2厅', '南北', '12', '精装', '有电梯', '374', '4368', '2008'], 
['海淀', '今日家园', '5室3厅', '西南', '18', '简装', '无电梯', '349', '1600', '2000'], 
['海淀', '西山壹号院', '4室2厅', '西南', '6', '毛坯', '有电梯', '347', '3750', '2011'], 
['海淀', '西山壹号院', '4室2厅', '西南', '6', '毛坯', '有电梯', '347', '3750', '2011'], 
['海淀', '西山壹号院', '3室3厅', '西南', '6', '精装', '有电梯', '321', '3850', '2011'], 
['海淀', '天秀花园古月园', '6室3厅', '西南', '6', '精装', '有电梯', '314', '2510', '2004']
## 2.3 输出年份由新到旧的10个房源


```python
def read_csv(file):
    """接收文件名为参数，返回二维列表"""
    data_ls = []
    with open(file, 'r', encoding='GBK') as fr:  # 以读模式创建文件对象，fr为文件对象名，表示file read，文件编码为GBK
        for line in fr:  # 遍历文件中行
            line_ls = line.strip().split(',')  # 去掉行末换行符，根据逗号切分为列表
            data_ls.append(line_ls)  # 当前行切得的列表加入到列表中
    return data_ls


def sorted_by_n(data_ls, n):
    """接收二维列表为参数，返回根据序号为n的列降序排序的二维列表"""
    data_of_sort = sorted(data_ls[1:], key=lambda x: float(x[n]), reverse=True)
    return [data_ls[0]] + data_of_sort


if __name__ == '__main__':
    filename = '/data/bigfiles/house.csv'  # 文件名
    house_info = read_csv(filename)  # 返回二维列表
    print(sorted_by_n(house_info, 9)[:10])  # 查看前10行数据

```
[['市区', '小区', '户型', '朝向', '楼层', '装修情况', '电梯', '面积(㎡)', '价格(万元)', '年份'], 
['海淀', '冠城大通百旺府', '2室2厅', '南北', '9', '毛坯', '无电梯', '107', '800', '2016'], 
['海淀', '京投银泰琨御府', '3室2厅', '南北', '6', '精装', '无电梯', '153', '2160', '2015'], 
['海淀', '五矿万科如园', '4室3厅', '东南', '10', '精装', '无电梯', '266', '2300', '2015'], 
['海淀', '京投银泰琨御府', '4室2厅', '南北', '6', '精装', '无电梯', '246', '3200', '2015'], 
['海淀', '橡树湾', '4室2厅', '南北', '25', '其他', '有电梯', '192', '1750', '2014'], 
['海淀', '金隅翡丽爱公馆', '2室1厅', '西北', '18', '精装', '无电梯', '69', '435', '2014'], 
['海淀', '世华龙樾', '3室2厅', '南北', '18', '毛坯', '有电梯', '146', '1380', '2014'],
['海淀', '世华龙樾', '3室2厅', '南北', '18', '毛坯', '有电梯', '147', '1380', '2014'], 
['海淀', '橡树湾', '3室1厅', '南北', '25', '其他', '有电梯', '177', '1620', '2014']]
## 2.4 输出单价由高到低的10个房源


```python
def read_csv(file):
    """接收文件名为参数，返回二维列表"""
    data_ls = []
    with open(file, 'r', encoding='GBK') as fr:  # 以读模式创建文件对象，fr为文件对象名，表示file read，文件编码为GBK
        for line in fr:  # 遍历文件中行
            line_ls = line.strip().split(',')  # 去掉行末换行符，根据逗号切分为列表
            data_ls.append(line_ls)  # 当前行切得的列表加入到列表中
    return data_ls


def sorted_by_n(data_ls):
    """接收二维列表为参数，返回根据单价降序排序的二维列表"""
    data_of_sort = sorted(data_ls[1:], key=lambda x: float(x[8])/float(x[7]), reverse=True)
    return [data_ls[0]] + data_of_sort


if __name__ == '__main__':
    filename = '/data/bigfiles/house.csv'  # 文件名
    house_info = read_csv(filename)  # 返回二维列表
    print(sorted_by_n(house_info)[:10])  # 查看前10行数据

```
[['市区', '小区', '户型', '朝向', '楼层', '装修情况', '电梯', '面积(㎡)', '价格(万元)', '年份'], 
['海淀', '光大水墨风景', '3室2厅', '南北', '16', '精装', '有电梯', '147', '2354', '2005'], 
['海淀', '光大水墨风景', '3室2厅', '南北', '16', '简装', '无电梯', '150', '2400', '2005'], 
['海淀', '光大水墨风景', '3室2厅', '南北', '16', '简装', '无电梯', '150', '2400', '2005'], 
['海淀', '光大水墨风景', '2室2厅', '南北', '16', '精装', '有电梯', '119', '1900', '2005'], 
['海淀', '碧水云天', '3室2厅', '南', '14', '精装', '有电梯', '146', '2280', '2004'], 
['海淀', '碧水云天', '3室2厅', '南', '14', '精装', '有电梯', '146', '2280', '2004'], 
['海淀', '碧水云天', '4室2厅', '西南', '14', '精装', '有电梯', '199', '3100', '2004'], 
['海淀', '碧水云天', '3室1厅', '南北', '13', '精装', '无电梯', '148', '2300', '2003'], 
['海淀', '蜂鸟家园', '1室0厅', '南', '16', '其他', '有电梯', '46', '700', '2004']]
## 2.5 为列表增加单价数据


```python
def read_csv(file):
    """接收文件名为参数，返回二维列表"""
    data_ls = []
    with open(file, 'r', encoding='GBK') as fr:  # 以读模式创建文件对象，fr为文件对象名，表示file read，文件编码为GBK
        for line in fr:  # 遍历文件中行
            line_ls = line.strip().split(',')  # 去掉行末换行符，根据逗号切分为列表
            data_ls.append(line_ls)  # 当前行切得的列表加入到列表中
    return data_ls


def add_price(data_ls):
    """接收二维列表为参数，增加单价数据，返回根据单价降序排序的二维列表"""
    data_with_price = []  # 创建空列表
    for sub_ls in data_ls[1:]:      # 遍历列表中数据部分
        sub_ls.append(str(int(float(sub_ls[8])/float(sub_ls[7]))))
        data_with_price.append(sub_ls)
    data_of_sort = sorted(data_with_price, key=lambda x: float(x[10]), reverse=True)
    return [data_ls[0]+['单价(万元)']] + data_of_sort


if __name__ == '__main__':
    filename = '/data/bigfiles/house.csv'  # 文件名
    house_info = read_csv(filename)  # 返回二维列表
    print(add_price(house_info)[:10])  # 查看前10行数据

```
[['市区', '小区', '户型', '朝向', '楼层', '装修情况', '电梯', '面积(㎡)', '价格(万元)', '年份', '单价(万元)'],
['海淀', '光大水墨风景', '3室2厅', '南北', '16', '简装', '无电梯', '150', '2400', '2005', '16'], 
['海淀', '光大水墨风景', '3室2厅', '南北', '16', '简装', '无电梯', '150', '2400', '2005', '16'], 
['海淀', '光大水墨风景', '3室2厅', '南北', '16', '精装', '有电梯', '147', '2354', '2005', '16'], 
['海淀', '蜂鸟家园', '1室0厅', '南', '14', '精装', '有电梯', '48', '730', '2004', '15'], 
['海淀', '碧水云天', '4室2厅', '西南', '14', '精装', '有电梯', '199', '3100', '2004', '15'], 
['海淀', '上地东里', '1室1厅', '南北', '6', '其他', '无电梯', '48', '720', '1996', '15'], 
['海淀', '光大水墨风景', '2室2厅', '南北', '16', '精装', '有电梯', '119', '1900', '2005', '15'], 
['海淀', '阳春光华家园', '2室2厅', '南北', '12', '精装', '无电梯', '103', '1550', '2001', '15'], 
['海淀', '康桥水郡', '3室2厅', '南北', '16', '精装', '有电梯', '160', '2400', '2003', '15']]
# 3. 选择房型

修改query_type()中的条件表达式，就可以获取不同筛选条件的房型数据


```python
def read_csv(file):
    """接收文件名为参数，返回二维列表"""
    data_ls = []
    with open(file, 'r', encoding='GBK') as fr:  # 以读模式创建文件对象，fr为文件对象名，表示file read，文件编码为GBK
        for line in fr:  # 遍历文件中行
            line_ls = line.strip().split(',')  # 去掉行末换行符，根据逗号切分为列表
            data_ls.append(line_ls)  # 当前行切得的列表加入到列表中
    return data_ls




def add_price(data_ls):
    """接收二维列表为参数，增加单价数据，返回根据单价降序排序的二维列表"""
    data_with_price = []  # 创建空列表
    for sub_ls in data_ls[1:]:      # 遍历列表中数据部分
        sub_ls.append(str(int(float(sub_ls[8])/float(sub_ls[7]))))
        data_with_price.append(sub_ls)
    data_with_price = [data_ls[0]+['单价(万元)']] + data_with_price
    return data_with_price


def query_type(data_with_price):
    """接收二维列表，返回精装修有电梯的数据"""
    # data_select = [sub_ls for sub_ls in data_with_price[1:] if sub_ls[5]== '精装' if sub_ls[6]=='有电梯']
    data_select = []
    for sub_ls in data_with_price[1:]:
        if sub_ls[5] == '精装' and sub_ls[6] == '有电梯':
            data_select.append(sub_ls)
    data_in_query =  [data_with_price[0]]+ data_select
    return data_in_query


def sort_data(data_in_query):
    """接收二维列表，返回排序的二维列表"""
    data_of_sort = sorted(data_in_query[1:], key=lambda x: float(x[10]), reverse=True)
    return [data_in_query[0]] + data_of_sort


if __name__ == '__main__':
    filename = '/data/bigfiles/house.csv'  # 文件名
    house_info = read_csv(filename)  # 返回二维列表
    house_price = add_price(house_info) # 查看前10行数据
    select_data = query_type(house_price)
    print(sort_data(select_data)[:10])

```
[['市区', '小区', '户型', '朝向', '楼层', '装修情况', '电梯', '面积(㎡)', '价格(万元)', '年份', '单价(万元)'], 
['海淀', '光大水墨风景', '3室2厅', '南北', '16', '精装', '有电梯', '147', '2354', '2005', '16'], 
['海淀', '蜂鸟家园', '1室0厅', '南', '14', '精装', '有电梯', '48', '730', '2004', '15'], 
['海淀', '碧水云天', '4室2厅', '西南', '14', '精装', '有电梯', '199', '3100', '2004', '15'], 
['海淀', '光大水墨风景', '2室2厅', '南北', '16', '精装', '有电梯', '119', '1900', '2005', '15'], 
['海淀', '康桥水郡', '3室2厅', '南北', '16', '精装', '有电梯', '160', '2400', '2003', '15'], 
['海淀', '康桥水郡', '3室2厅', '南北', '16', '精装', '有电梯', '160', '2400', '2003', '15'], 
['海淀', '中海紫金苑', '2室2厅', '南北', '13', '精装', '有电梯', '180', '2700', '2002', '15'], 
['海淀', '碧水云天', '3室2厅', '南', '14', '精装', '有电梯', '146', '2280', '2004', '15'], 
['海淀', '碧水云天', '3室2厅', '南', '14', '精装', '有电梯', '146', '2280', '2004', '15']]

```python

```
[house.csv](./数据集/house.csv)
/data/bigfiles/house.csv
